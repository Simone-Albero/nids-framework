from matplotlib import pyplot as plt
import pandas as pd
from io import StringIO
import os

def plot():
    data_1 = """Precision,Recall,F1,Balanced Accuracy,TN,FN,FP,TP
0.8280432213405369,0.9989561320874812,0.9055053599658439,0.6189793269011237,2559,8148,41,39236
0.859565179043923,0.9925147032614507,0.9212681232201726,0.6988351045026783,4338,6369,294,38983
0.826227852363116,0.9996690174911526,0.904710883765942,0.6141989432276908,2449,8258,13,39264
0.8555606728512841,0.9932275886651221,0.9192685628107549,0.689057989718757,4121,6586,266,39011
0.8997168362449607,0.9545790157089391,0.9263363352234123,0.7821368040158593,6528,4179,1784,37493
0.8778208188820323,0.9923619421035211,0.9315837904372662,0.7428420339078361,5282,5425,300,38977
0.8897404713279332,0.9871935229269038,0.9359370474075506,0.7692108457074045,5902,4805,503,38774
0.8695991091314031,0.994093235226723,0.9276880858191667,0.7236273591842964,4852,5855,232,39045
0.8994652899419194,0.993609491559946,0.9441964555737012,0.7931062307897797,6345,4362,251,39026
0.8879284920256811,0.9964864933676197,0.939080570084937,0.7675530440126601,5767,4940,138,39139
    """

    data_2 = """Precision,Recall,F1,Balanced Accuracy,TN,FN,FP,TP
0.8051444824601179,0.9945769788935,0.889891223873797,0.5558016117032177,1253,9454,213,39064
0.8160816581606083,0.9974539158773806,0.8976982390210927,0.5864650976473194,1879,8829,100,39176
0.9417523703635072,0.7763378990783645,0.851082238999679,0.8000874998847829,8820,1886,8785,30493
0.9403603548297983,0.7800183318056828,0.8527172778512281,0.7992826063212202,8765,1943,8640,30636
0.8277961642905635,0.9934565638048681,0.9030921631254919,0.6177125926981009,2591,8117,257,39019
0.8250895302296187,0.9971739905290493,0.9030064093696684,0.6108137839811322,2403,8303,111,39167
0.8385101200612162,0.9904017516166811,0.9081486150506006,0.6453036219320095,3214,7492,377,38901
0.8357228451596337,0.9943731540890111,0.9081713328992652,0.6387162744669934,3031,7677,221,39055
0.8312847030898995,0.998650644126483,0.9073140266469281,0.6275244627320253,2745,7961,53,39225
0.9072263295969473,0.9684564270984496,0.9368419756430937,0.8025374148570249,6815,3890,1239,38040
    """

    df_1 = pd.read_csv(StringIO(data_1))
    df_2 = pd.read_csv(StringIO(data_2))
    x_ticks = range(50, 501, 50)

    plt.figure(figsize=(12, 8))

    colors_semi_supervised = {
        'Precision': '#1f77b4',
        'Recall': '#2ca02c',
        'F1': 'red',
        'Balanced Accuracy': 'orange'
    }

    colors_supervised = {
        'Precision': 'DodgerBlue',
        'Recall': 'green',
        'F1': 'red',
        'Balanced Accuracy': 'orange'
    }

    #metrics = ['Precision', 'Recall']
    #metrics = ['F1', 'Balanced Accuracy']
    metrics = ['F1']
    # (Semi-Supervised)
    for metric in metrics:
        plt.plot(x_ticks, df_1[metric], marker='o', linestyle='-', color=colors_semi_supervised[metric], label=f'{metric} (Self-Supervised)')

    # (Supervised)
    for metric in metrics:
        plt.plot(x_ticks, df_2[metric], marker='x', linestyle='--', color=colors_supervised[metric], label=f'{metric} (Supervised)')

    plt.xlabel('Batches', fontsize=20)
    plt.ylabel('Value', fontsize=20)
    plt.xticks(x_ticks, fontsize=16)
    plt.yticks(fontsize=16)
    plt.legend(fontsize=16, title='Metrics', title_fontsize='16')
    plt.grid(True, linestyle='--') 

    plot_filename = os.path.join("figures", "NF-ToN-IoT-V2.png")
    plt.savefig(plot_filename)
    plt.close()

if __name__ == "__main__":
    plot()
